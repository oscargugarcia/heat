% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/aggregation.R
\name{temp_agg}
\alias{temp_agg}
\title{Temporal Aggregation of Wide Spatial Extraction Results (With Optional Metadata Retention)}
\usage{
temp_agg(spatial_output, agg_args, keep_metadata = TRUE)
}
\arguments{
\item{:}{\itemize{
\item spatial_output: A data.table or data.frame produced by spatial aggregation, containing
identifier columns (e.g., "poly_id" and "trans_var") and additional columns whose names
represent dates in one of the formats: "YYYY", "YYYY-MM", or "YYYY-MM-DD". Any additional
columns are assumed to be metadata.
\itemize{
\item agg_args: A list of aggregation arguments including:
- out_temp_res: character; the desired output temporal resolution ("daily", "monthly", or "yearly").
- temp_agg_fun: function; the aggregation function to apply (default is sum if not specified).
- Any other arguments are passed to the aggregation function.
\item keep_metadata: Logical (default TRUE). If TRUE, retains all non-date columns from spatial_output.
If FALSE, only the identifier columns ("poly_id" and "trans_var") are retained.
}
}}
}
\value{
:
\itemize{
\item A wide-format data.table with the identifier columns (and, if keep_metadata = TRUE, additional metadata columns)
and one column per aggregated time period (named by the aggregated date). For daily resolution, the original
data is returned.
}
}
\description{
This function aggregates the wide-format spatial extraction output over time according
to a specified temporal resolution. It robustly identifies date columns using lubridate
and a regex check (accepting formats "YYYY", "YYYY-MM", or "YYYY-MM-DD"). An aggregation key is
created based on the desired resolution ("daily", "monthly", or "yearly"), and the specified
aggregation function (default: sum) is applied row-wise to columns with the same key.

By default, the function retains all non-date columns (metadata) present in the input.
If \code{keep_metadata = FALSE}, only the identifier columns (defined as "poly_id" and "trans_var")
are retained.
}
\examples{
  agg_args <- list(
    out_temp_res = "monthly",
    temp_agg_fun = mean
  )
  aggregated_DT <- temp_agg(spatial_output, agg_args)
}
