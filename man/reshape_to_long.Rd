% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils.R
\name{reshape_to_long}
\alias{reshape_to_long}
\title{Reshape Wide Data to Long Format by Processing Each trans_var Separately with Optional Time Columns}
\usage{
reshape_to_long(
  wide_dt,
  id_cols = c("poly_id", "trans_type"),
  trans_var = "trans_var",
  add_time_columns = TRUE
)
}
\arguments{
\item{:}{\itemize{
\item wide_dt: A wide-format data.table or data.frame containing identifier columns, a trans_var column,
date columns, and possibly other columns.
\itemize{
\item id_cols: A character vector of identifier column names that must always be retained.
Default is c("poly_id", "trans_type").
\item trans_var: A character string specifying the column name that holds the variable used for subsetting.
Default is "trans_var".
\item add_time_columns: Logical. If TRUE (default), additional time columns are added based on the detected temporal resolution.
}
}}
}
\value{
:
\itemize{
\item A long-format data.table that contains the identifier columns, a "date" column, one column per unique trans_var
containing the melted data, and optionally additional time columns.
}
}
\description{
This function reshapes a wide-format data.table (or data.frame) into a long-format data.table
by processing each unique trans_var separately and optimizing the merge operation using keys.
It first identifies the date columns and their temporal resolution using the get_date_cols and get_temp_res functions.
For each unique value in the trans_var column, it subsets the data, melts the subset using the identifier
columns, and renames the resulting value column to the corresponding trans_var value. The melted columns are then
merged sequentially into a long-format data.table using keyed joins.

Optionally, time columns (year, month, day) are added based on the detected temporal resolution.
}
\examples{
  # Suppose wide_dt is a data.table with columns "poly_id", "trans_type", "trans_var",
  # and date columns like "2017-01-01", "2017-01-02", etc.
  long_dt <- reshape_to_long(wide_dt)
}
